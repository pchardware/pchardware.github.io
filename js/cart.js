function addCartItem(n,t,i){if(n==null||t==null||i==null)return!1;let e=document.createElement("tr");e.setAttribute("class","table_row");let r=document.createElement("td");r.setAttribute("class","column-1");let u=document.createElement("div");u.setAttribute("class","how-itemcart1");u.addEventListener("click",()=>removeCartItemFromView(i.slug,$(e)));let h=document.createElement("img");h.setAttribute("src","./images/products/"+i.slug+"-0.webp");h.setAttribute("alt","im�gen del art�culo");h.setAttribute("loading","lazy");u.appendChild(h);r.appendChild(u);e.appendChild(r);r=document.createElement("td");r.setAttribute("class","column-2");aElement=document.createElement("a");aElement.setAttribute("class","cl3");aElement.setAttribute("href","product.html?id="+i.slug);aElement.textContent=i.Label;r.appendChild(aElement);e.appendChild(r);r=document.createElement("td");r.setAttribute("class","column-3");r.textContent=toMoneyStr(i.Price);e.appendChild(r);r=document.createElement("td");r.setAttribute("class","column-4");u=document.createElement("div");u.setAttribute("class","wrap-num-product flex-w m-l-auto m-r-0");let o=document.createElement("div");o.setAttribute("class","btn-num-product-down cl8 hov-btn3 trans-04 flex-c-m");let s=document.createElement("i");s.setAttribute("class","fs-16 zmdi zmdi-minus");o.appendChild(s);u.appendChild(o);let f=document.createElement("input");return f.setAttribute("class","mtext-104 cl3 txt-center num-product"),f.setAttribute("type","number"),f.setAttribute("name","num-"+i.slug),f.setAttribute("value",t.qty),f.setAttribute("min",0),f.setAttribute("max",99),f.setAttribute("price",i.Price),f.setAttribute("label",i.Label),f.addEventListener("input",()=>updateCartTotals()),u.appendChild(f),o=document.createElement("div"),o.setAttribute("class","btn-num-product-up cl8 hov-btn3 trans-04 flex-c-m"),s=document.createElement("i"),s.setAttribute("class","fs-16 zmdi zmdi-plus"),o.appendChild(s),u.appendChild(o),r.appendChild(u),e.appendChild(r),r=document.createElement("td"),r.setAttribute("class","column-5"),r.textContent=toMoneyStr(i.Price*t.qty),e.appendChild(r),n.append(e),!0}function updateCart(){let i=$(".table-shopping-cart");i.empty();let t=document.createElement("tr");t.setAttribute("class","table_head");let n=document.createElement("th");n.setAttribute("class","column-1");n.textContent=spanishFormat("Articulo");t.appendChild(n);n=document.createElement("th");n.setAttribute("class","column-2");t.appendChild(n);n=document.createElement("th");n.setAttribute("class","column-3");n.textContent="Precio";t.appendChild(n);n=document.createElement("th");n.setAttribute("class","column-4");n.textContent="Cantidad";t.appendChild(n);n=document.createElement("th");n.setAttribute("class","column-5");n.textContent="Total";t.appendChild(n);i.append(t);let r=getCart(),u=[];for(let n of r.items)addCartItem(i,n,productSlugs[n.productId])||u.push(n.productId);for(let n of u)removeCartItem(r,n);$(".btn-num-product-down").on("click",function(){let n=$(this).next();var t=Number(n.val());t>0&&(n.val(t-1).change(),updateCartTotals())});$(".btn-num-product-up").on("click",function(){let n=$(this).prev();var t=Number(n.val());t<99&&(n.val(t+1).change(),updateCartTotals())});updateCartTotals(!1)}function clearCart(){let n=getCart();n.items=[];addStorage("cart",n);updateCart()}function updateCartTotals(n=true){let t={items:[]},i=0;$(".num-product").each(function(n,r){let e=$(r).attr("name").substring(4),u=$(r).val(),o=$(r).attr("price"),f=o*u;t.items.push({productId:e,qty:u});let s=$(this).parent().parent(),h=s.next(),c=toMoneyStr(f);h.text(c);i+=f});let r=$("span.mtext-110.cl2"),u=toMoneyStr(i);r.text(u);n&&addStorage("cart",t)}function removeCartItemFromView(n,t){let i=getCart();t.remove();removeCartItem(i,n)}function removeCartItem(n,t){n.items=n.items.filter(function(n){return n.productId!==t});addStorage("cart",n);updateCartTotals(!1)}function sendOrder(){let n="Hola, quiero esta orden:\n";n+="------------------------------\n";let t=0;var i=[];$(".num-product").each(function(r,u){let e=$(u).attr("label"),f=$(u).val();if(!(f<=0)){let o=$(u).attr("price");n+="- "+f+"x $"+o+" "+e+"\n";let s=o*f;t+=s;var h={id:ToSlug(e),name:e,quantity:f,price:o};i.push(h)}});n+="\nTotal: $"+t;let r="https://wa.me/+"+contactCell+"?text="+encodeURIComponent(n);window.open(r);googleAnalyticsId!=null&&googleAnalyticsId.length>0&&i.length>0&&gtag("event","purchase",{transaction_id:"trans_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),value:t,currency:"USD",items:i})}var productSlugs=[];(function(n){"use strict";n.getJSON("./data/products-index.json",function(t){if(t!=null){productSlugs=[];for(let n in t){let i=t[n];for(let n in i){let t=i[n];for(let n of t){let t=ToSlug(n.Label);n.slug=t;productSlugs[t]=n}}}updateCart();n("button.pointer").on("click",function(n){n.preventDefault();sendOrder()});n(".clearcart").on("click",function(){clearCart()})}});window.addEventListener("storage",function(n){n.key==="cart"&&updateCart()})})(jQuery)